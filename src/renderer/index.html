<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>m-Alice - Anti-AI Learning Tool</title>
    <link rel="stylesheet" href="styles.css">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:;">
</head>
<body>
    <!-- <h1>m-Alice</h1> -->
    <div class="wrapper">
        <aside class="side-menu">
            <div class="side-menu-icons">
                <button class="menu-btn"><img src="img/python.svg" alt="python"></button>
                <button class="menu-btn"><img src="img/setting.svg" alt="setting"></button>
            </div>
        </aside>
        <main class="container">
            <div class="image-container">
                <div class="image-box">
                    <div id="beforeImage" class="image-display">
                        <p class="text-center">Click<br>or<br>Drop image</p>
                    </div>
                    <div class="file-name">
                        <span id="defaultName">Default Name</span>
                    </div>
                    <div class="action-buttons">
                        <button id="processBtn" disabled>Infuse Malice</button>
                    </div>
                </div>
                
                <div class="image-box">
                    <div id="afterImage" class="image-display">
                        <p>After Image</p>
                    </div>
                    <div class="file-name">
                        <span id="outputName">Output Name</span>
                    </div>
                    <div class="metadata-button-container">
                        <button id="viewMetadataBtn" disabled>Display Metadata</button>
                    </div>
                </div>
            </div>
            
            <div class="controls-container">
                <div class="left-controls">
                    <div class="control-group">
                        <h3>Watermark</h3>
                        <div class="watermark-toggle">
                            <label class="switch">
                                <input type="checkbox" id="watermarkToggle">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="watermark-select">
                            <select id="watermarkSelect" disabled>
                                <option value="no_ai">No AI</option>
                                <option value="all_rights_reserved">All Rights Reserved</option>
                            </select>
                        </div>
                        <div class="mt-10 watermark-invert-toggle">
                            <label>
                                <input type="checkbox" id="invertWatermarkToggle" disabled>
                                Invert (Black / White)
                            </label>
                        </div>
                        <div class="mt-10 watermark-outline-toggle">
                            <label>
                                <input type="checkbox" id="enableOutlineToggle" checked disabled>
                                Enable Outline
                            </label>
                        </div>
                        
                        <!-- アウトライン色選択機能を追加 -->
                        <div class="outline-color-controls" id="outlineColorControls">
                            <div class="color-picker-label">
                                <label for="outlineColorPicker">Outline Color:</label>
                                <div class="color-preview" id="colorPreview"></div>
                            </div>
                            <div class="color-sliders">
                                <div class="color-slider">
                                    <label>R</label>
                                    <input type="range" id="redSlider" min="0" max="255" value="255" class="color-range">
                                    <span id="redValue">255</span>
                                </div>
                                <div class="color-slider">
                                    <label>G</label>
                                    <input type="range" id="greenSlider" min="0" max="255" value="255" class="color-range">
                                    <span id="greenValue">255</span>
                                </div>
                                <div class="color-slider">
                                    <label>B</label>
                                    <input type="range" id="blueSlider" min="0" max="255" value="255" class="color-range">
                                    <span id="blueValue">255</span>
                                </div>
                            </div>
                            <button id="autoColorBtn" class="auto-color-btn">Auto Color</button>
                        </div>
                          <div class="slider-option">
                            <label for="watermarkOpacity">Watermark Opacity:</label>
                            <div class="slider-with-value">
                                <input type="range" id="watermarkOpacity" name="watermarkOpacity" min="5" max="100" value="75">
                                <span id="opacityValue">75%</span>
                            </div>
                        </div>
                        <div class="slider-option">
                            <label for="watermarkSize">Watermark Size:</label>
                            <div class="slider-with-value">
                                <input type="range" id="watermarkSize" name="watermarkSize" min="30" max="95" value="75">
                                <span id="sizeValue">75%</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="right-controls">
                    <div class="control-group">
                        <h3>Noise</h3>
                        <div class="slider-container">
                            <span>-</span>
                            <input type="range" id="noiseSlider" min="0" max="7" value="3" step="1">
                            <span>+</span>
                        </div>
                        <div class="noise-level-display">
                            <span id="noiseLevelText">Moderate (Lv.4)</span>
                        </div>
                    </div>
                    <hr>
                    <div class="control-group">
                        <h3>Resize</h3>
                        <div class="resize-options">
                            <label>
                                <input type="radio" name="resize" value="default" checked> Default
                            </label>
                            <label>
                                <input type="radio" name="resize" value="medium"> Medium
                            </label>
                            <label>
                                <input type="radio" name="resize" value="small"> Small
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- モーダル表示のためのコンポーネント -->
        <div id="modalOverlay" class="modal-overlay">
            <div class="modal-container">
                <div class="modal-header">
                    <h3 id="modalTitle">m-alice</h3>
                    <button id="modalCloseBtn" class="modal-close-btn">&times;</button>
                </div>
                <div class="modal-content">
                    <p id="modalMessage"></p>
                    <div id="modalDetailsContainer" class="details-container">
                        <button id="showDetailsBtn" class="details-toggle-btn">詳細情報を表示</button>
                        <div id="modalDetails" class="details-content"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="modalOkBtn" class="modal-btn modal-ok-btn">OK</button>
                </div>
            </div>
        </div>
        
        <!-- 設定モーダル -->
        <div id="settingsModalOverlay" class="modal-overlay">
            <div class="modal-container settings-modal-container">
                <div class="modal-header">
                    <h3>Setting</h3>
                    <button id="settingsModalCloseBtn" class="modal-close-btn">&times;</button>
                </div>
                <div class="modal-content">
                    <div class="settings-section">
                        <h4>Logo display position</h4>
                        <div class="logo-position-options">
                            <label>
                                <input type="radio" name="logoPosition" value="random" checked> Random (Default)
                            </label>
                            <div class="flex">
                                <label>
                                    <input type="radio" name="logoPosition" value="top-left"> left/ top
                                </label>
                                <label>
                                    <input type="radio" name="logoPosition" value="top-right"> right / top
                                </label>
                            </div>
                            <div class="flex">
                                <label>
                                    <input type="radio" name="logoPosition" value="bottom-left"> left / bottom
                                </label>
                                <label>
                                    <input type="radio" name="logoPosition" value="bottom-right"> right / bottom
                                </label>
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div class="settings-section">
                        <h4>Noise types</h4>
                        <div class="noise-types-options">
                            <p>Choose which noise types to apply:</p>
                            <div class="checkbox-list">
                                <label>
                                    <input type="checkbox" name="noiseTypes" value="gaussian" checked> Gaussian noise (Default)
                                </label>
                                <label>
                                    <input type="checkbox" name="noiseTypes" value="dct" checked> DCT noise (Default)
                                </label>
                                <label>
                                    <input type="checkbox" name="noiseTypes" value="speckle"> Speckle noise
                                </label>
                                <label>
                                    <input type="checkbox" name="noiseTypes" value="shot"> Shot noise (Salt & Pepper)
                                </label>
                                <label>
                                    <input type="checkbox" name="noiseTypes" value="himalayan"> Himalayan Salt & Pepper
                                </label>
                                <label>
                                    <input type="checkbox" name="noiseTypes" value="mustard"> Mustard Noise
                                </label>
                                <p>* Shot noise は非常に強い影響がでます</p>
                                <p>* Himalayan Salt & Pepper は Shot noise にピンク色の要素を追加します</p>
                                <p>* Mustard Noise は特徴的な黄褐色の粒子ノイズで、AI学習を効果的に妨害します</p>
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div class="settings-section">
                        <h4>Output Format</h4>
                        <div class="output-format-options">
                            <p>Choose the output image format:</p>
                            <div class="radio-list">
                                <label>
                                    <input type="radio" name="outputFormat" value="png" checked> PNG (Default)
                                    <small>Best quality and compatibility</small>
                                </label>
                                <label>
                                    <input type="radio" name="outputFormat" value="webp"> WebP (Lossless)
                                    <small>Smaller file size with full protection effect</small>
                                </label>
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div class="settings-section">
                        <h4>Metadata</h4>
                        <div class="metadata-options">
                            <p>Manage image metadata settings:</p>
                            <div class="checkbox-list">
                                <label>
                                    <input type="checkbox" id="removeMetadata" name="removeMetadata" checked>
                                    Remove all metadata
                                    <small>Removes all private information like camera details, location, etc.</small>
                                </label>
                                <label>
                                    <input type="checkbox" id="addFakeMetadata" name="addFakeMetadata" checked>
                                    Add fake metadata
                                </label>
                                <div class="sub-option">
                                    <select id="fakeMetadataType" name="fakeMetadataType">
                                        <option value="random">Random (Recommended)</option>
                                        <option value="paint">Paint software</option>
                                        <option value="old_camera">Old camera</option>
                                        <option value="screenshot">Screenshot</option>
                                    </select>
                                </div>
                                <label>
                                    <input type="checkbox" id="addNoAIFlag" name="addNoAIFlag" checked>
                                    Add AI training prohibition flag
                                    <small>Embeds flags that may be recognized by AI models</small>
                                </label>
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div class="settings-section">
                        <h4>Language</h4>
                        <div class="language-select">
                            <label for="languageDropdown">Select Language:</label>
                            <select id="languageDropdown" onchange="setLanguage(this.value)">
                                <!-- Options will be dynamically populated -->
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="settingsSaveBtn" class="modal-btn modal-ok-btn">Save</button>
                    <button id="settingsCancelBtn" class="modal-btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    <script src="js/index.js"></script>
    <script>
        const { setLanguage } = require('./js/utils/translation');

        window.setLanguage = (lang) => {
            setLanguage(lang);
            alert(`Language switched to: ${lang}`);
            location.reload(); // ページをリロードして言語を反映
        };
    </script>
</body>
</html>